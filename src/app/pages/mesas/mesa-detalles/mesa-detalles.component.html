<nz-page-header nzBackIcon [nzGhost]="false">
	<nz-page-header-title>
		Detalle de Mesa
	</nz-page-header-title>
	<nz-page-header-extra>
		<a [routerLink]="['/mesas', mesa().mesaId, 'agenda']" class="px-4 py-2 rounded border border-sky-700 bg-sky-700 text-white hover:border-sky-900 hover:bg-sky-900 hover:text-white">
			VER AGENDA / CARTERA
		</a>
	</nz-page-header-extra>
</nz-page-header>

<div class="grid grid-cols-1 md:grid-cols-6 bg-white p-4">
	<div class="flex border border-gray-200">
		<div class="flex items-center min-w-[80px] pl-2 pr-4 py-1 font-semibold bg-gray-100">Codigo</div>
		<div class="w-full flex items-center  px-2 py-1 border-l border-gray-200">{{mesa().codigo}}</div>
	</div>
	<div class="flex col-span-2 border border-gray-200">
		<div class="flex items-center min-w-[124px] pl-2 pr-4 py-1 font-semibold bg-gray-100">Nombre</div>
		<div class="w-full flex items-center px-2 py-1 border-l border-gray-200">
			{{mesa().nombre}}
		</div>
	</div>
	<div class="flex border border-gray-200">
		<div class="flex items-center min-w-[124px] pl-2 pr-4 py-1 font-semibold bg-gray-100">Abreviatura</div>
		<div class="w-full flex items-center px-2 py-1 border-l border-gray-200">
			{{mesa().abreviatura}}
		</div>
	</div>
	<div class="flex border border-gray-200">
		<div class="flex items-center min-w-[124px] pl-2 pr-4 py-1 font-semibold bg-gray-100">Estado</div>
		<div class="w-full flex items-center px-2 py-1 border-l border-gray-200">
			<app-estado-tag [estado]="mesa().estadoRegistroNombre!"></app-estado-tag>
		</div>
	</div>
	<div class="flex border order-gray-200">
		<div class="flex items-center min-w-[80px] pl-2 pr-4 py-1 font-semibold bg-gray-100">Resoluci贸n</div>
		<div class="w-full flex items-center justify-between px-2 py-1 border-l border-gray-200 overflow-hidden">
			<div class="flex w-full overflow-hidden">
				<app-boton-descargar [rutaArchivo]="mesa().resolucion" [titulo]="'Descargar Resolucion'"></app-boton-descargar>
				@for(resolucion of documentosResolucion(); track $index){
					<app-boton-descargar [rutaArchivo]="resolucion.archivo" [titulo]="'Descargar ' + resolucion.nombre" [active]="false" />
				}
			</div>
			<div class="py-1 px-2 text-sky-700 cursor-pointer border border-sky-700 rounded hover:bg-sky-700 hover:text-white" nz-tooltip nzTooltipTitle="Nueva Ampliaci贸n" (click)="modalCreateFile(2)"><span nz-icon nzType="plus" nzTheme="outline"></span></div>
		</div>
	</div>
	<div class="flex border border-gray-200 border-t-0">
		<div class="flex items-center min-w-[80px] pl-2 pr-4 py-1 font-semibold bg-gray-100">Sector</div>
		<div class="w-full flex items-center  px-2 py-1 border-l border-grey-200">{{mesa().sector}}</div>
	</div>
	<div class="flex col-span-2 border border-gray-200 border-t-0">
		<div class="flex items-center min-w-[124px] pl-2 pr-4 py-1 font-semibold bg-gray-100">Secretaria Tecnica</div>
		<div class="w-full flex items-center  px-2 py-1 border-l border-grey-200">{{mesa().secretariaTecnica}}</div>
	</div>
	<div class="flex border border-gray-200 border-t-0">
		<div class="flex items-center min-w-[124px] pl-2 pr-4 py-1 font-semibold bg-gray-100">Fecha de creaci贸n</div>
		<div class="w-full flex items-center  px-2 py-1 border-l border-grey-200">{{mesa().fechaCreacion}}</div>
	</div>
	<div class="flex border border-gray-200 border-t-0">
		<div class="flex items-center min-w-[124px] pl-2 pr-4 py-1 font-semibold bg-gray-100">Fecha de vigencia</div>
		<div class="w-full flex items-center  px-2 py-1 border-l border-grey-200">{{mesa().fechaVigencia}}</div>
	</div>
	<div class="flex border border-gray-200 border-t-0">
		<div class="flex items-center min-w-[80px] pl-2 pr-4 py-1 font-semibold bg-gray-100">Acciones</div>
		<div class="w-full flex items-center px-2 py-1 border-l border-grey-200">
			<div class="py-1 px-2 text-sky-700 cursor-pointer border border-sky-700 rounded hover:bg-sky-700 hover:text-white" nz-tooltip nzTooltipTitle="Actualizar mesa" (click)="actualizarMesa()"><span nz-icon nzType="edit" nzTheme="outline"></span></div>
		</div>
	</div>
</div>

<div class="grid grid-cols-2 gap-4 mt-4">
	<div class="flex flex-col bg-white border border-solid border-grey-200">
		<div class="flex items-center justify-between px-4 py-3 border border-solid border-grey-200">
			<h5 class="m-0 text-base font-semibold">Integrantes GN</h5>
			<!-- <div class="rounded border border-sky-700 text-sky-700 px-3 py-2 cursor-pointer hover:bg-sky-700 hover:text-white">
				Nuevo integrante
			</div> -->
		</div>
		<div class="w-full flex border-solid ">
			<nz-table nzSize="small" nzShowSizeChanger [nzData]="integranteSectores()"
				[nzFrontPagination]="false" [nzShowPagination]="paginationSectores.pageSize! > 5"
				[nzLoading]="loadingSectores" [nzTotal]="paginationSectores.total!" [nzPageSize]="paginationSectores.pageSize!"
				[nzPageIndex]="paginationSectores.currentPage!">
				<thead>
					<tr>
						<th nzAlign="center" nzWidth="64px">Nro</th>
						<th nzAlign="center">Sector</th>
						<th nzAlign="center">Titular</th>
						<th nzAlign="center" nzWidth="80px"></th>
					</tr>
				</thead>
				<tbody>
					@for(integrante of integranteSectores(); track $index){
					<tr>
						<td nzAlign="center">{{$index + 1}}</td>
						<td nzAlign="center">
							{{integrante.sector}}
							<br>{{integrante.entidad}}
						</td>
						<td nzAlign="center">
							{{integrante.dni}} <br>
							{{integrante.nombres}} {{integrante.apellidos}}  @if(integrante.telefono){ - {{integrante.telefono}} }
						</td>
						<td>
							<!-- <button nz-button nzType="link" nz-tooltip="Actualizar Integrante"><span nz-icon nzType="edit" nzTheme="outline"></span></button>
							<button nz-button nzDanger nzType="link" nz-tooltip="Eliminar Integrante" ><span nz-icon nzType="delete" nzTheme="outline"></span></button> -->
						</td>
					<tr>
					}
				</tbody>
			</nz-table>
		</div>
	</div>

	<div class="w-full flex flex-col bg-white border border-solid border-grey-200">
		<div class="flex items-center justify-between px-4 py-3 border border-solid border-grey-200">
			<h5 class="m-0 text-base font-semibold">Integrantes GR/GL</h5>
			<!-- <div class="rounded border border-sky-700 text-sky-700 px-3 py-2 cursor-pointer hover:bg-sky-700 hover:text-white">
				Nuevo integrante
			</div> -->
		</div>
		<div class="flex border-solid ">
			<nz-table nzSize="small" nzShowSizeChanger [nzData]="integranteUbigeos()"
				[nzFrontPagination]="false" [nzShowPagination]="paginationUbigeos.pageSize! > 5"
				[nzLoading]="loadingUbigeos" [nzTotal]="paginationUbigeos.total!" [nzPageSize]="paginationUbigeos.pageSize!"
				[nzPageIndex]="paginationUbigeos.currentPage!">
				<thead>
					<tr>
						<th nzAlign="center" nzWidth="64px">Nro</th>
						<th nzAlign="center">Gobierno</th>
						<th nzAlign="center">Representante</th>
						<th nzAlign="center" nzWidth="80px"></th>
					</tr>
				</thead>
				<tbody>
					@for(integrante of integranteUbigeos(); track $index){
					<tr>
						<td nzAlign="center">{{$index + 1}}</td>
						<td nzAlign="center">
							{{integrante.departamento}}
							@if(integrante.provincia){ - {{integrante.provincia}} }
							@if(integrante.distrito){ - {{integrante.distrito}} }
							<br>{{integrante.entidad}}</td>
						<td nzAlign="center">
							@if(integrante.autoridad){ AUTORIDAD } @else { REPRESENTANTE }<br>
							{{integrante.dni}}
							- {{integrante.nombres}}
							{{integrante.apellidos}}  @if(integrante.telefono){ - {{integrante.telefono}} }
						</td>
						<td>
							<!-- <button nz-button nzType="link" nz-tooltip="Actualizar Integrante"><span nz-icon nzType="edit" nzTheme="outline"></span></button>
							<button nz-button nzDanger nzType="link" nz-tooltip="Eliminar Integrante" ><span nz-icon nzType="delete" nzTheme="outline"></span></button> -->
						</td>
					<tr>
					}
				</tbody>
			</nz-table>
		</div>
	</div>
</div>

<div class="grid grid-cols-2 gap-4 mt-4">
	<div class="w-full flex flex-col bg-white border border-solid border-grey-200">
		<div class="flex items-center justify-between px-4 py-3 border border-solid border-grey-200">
			<h5 class="m-0 text-base font-semibold">Sesiones</h5>
			@if (mesa().estadoRegistroNombre != 'cerrado') {
				<div class="rounded border border-sky-700 text-sky-700 px-3 py-2 cursor-pointer hover:bg-sky-700 hover:text-white" (click)="modalCreateFile(0)">
					Nueva sesi贸n
				</div>
			}
		</div>
		<div class="flex border-solid ">
			<nz-table [nzData]="mesasSesion()" class="w-full" [nzFrontPagination]="false" [nzShowPagination]="false" >
				<thead>
					<tr>
						<th nzAlign="center" nzWidth="64px">Nro</th>
						<th nzAlign="center">Nombre archivo</th>
						<th nzAlign="center">Usuario</th>
						<th nzAlign="center">Fecha</th>
						<th nzAlign="center" nzWidth="80px"></th>
					</tr>
				</thead>
				<tbody>
					@for(detalle of mesasSesion(); track $index){
					<tr>
						<td nzAlign="center">{{$index + 1}}</td>
						<td nzAlign="center">{{detalle.nombre}}</td>
						<td nzAlign="center">{{detalle.responsable}}</td>
						<td nzAlign="center">{{detalle.fechaCreacion}}</td>
						<td nzAlign="center">
							<div class="flex justify-center gap-1">
								<app-boton-descargar [rutaArchivo]="detalle.archivo"></app-boton-descargar>
								<button nz-button nzDanger nzType="link" nz-tooltip nzTooltipTitle="Eliminar" (click)="deleteMesaDetalle(detalle,0)">
									<span nz-icon nzType="delete" nzTheme="outline"></span>
								</button>
							</div>
						</td>
					</tr>
					}
				</tbody>
			</nz-table>
		</div>
	</div>

	<div class="w-full flex flex-col bg-white border border-solid border-grey-200">
		<div class="flex items-center justify-between px-4 py-3 border border-solid border-grey-200">
			<h5 class="m-0 text-base font-semibold">AM</h5>
			@if (mesa().estadoRegistroNombre != 'cerrado') {
				<div class="rounded border border-sky-700 text-sky-700 px-3 py-2 cursor-pointer hover:bg-sky-700 hover:text-white" (click)="modalCreateFile(1)">
					Nueva am
				</div>
			}
		</div>
		<div class="flex border-solid ">
			<nz-table [nzData]="mesasAm()" class="w-full" [nzFrontPagination]="false" [nzShowPagination]="false" >
				<thead>
					<tr>
						<th nzWidth="64px" nzAlign="center">Nro</th>
						<th nzAlign="center">Nombre archivo</th>
						<th nzAlign="center">Usuario</th>
						<th nzAlign="center">Fecha</th>
						<th nzWidth="80px"></th>
					</tr>
				</thead>
				<tbody>
					@for(detalle of mesasAm(); track $index){
					<tr>
						<td nzAlign="center">{{$index + 1}}</td>
						<td nzAlign="center">{{detalle.nombre}}</td>
						<td nzAlign="center">{{detalle.responsable}}</td>
						<td nzAlign="center">{{detalle.fechaCreacion}}</td>
						<td nzAlign="center">
							<div class="flex justify-center gap-1">
								<app-boton-descargar [rutaArchivo]="detalle.archivo"></app-boton-descargar>
								<button nz-button nzDanger nzType="link" nz-tooltip nzTooltipTitle="Eliminar" (click)="deleteMesaDetalle(detalle,1)">
									<span nz-icon nzType="delete" nzTheme="outline"></span>
								</button>
							</div>
						</td>
					</tr>
					}
				</tbody>
			</nz-table>
		</div>
	</div>
</div>